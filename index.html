<html><head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
</head>
<body>
    
<form accept-charset="UTF-8" action="" method="">
First name:<br>
<input type="text" name="firstname"><br>
Last name:<br>
<input type="text" name="lastname">
<input type="hidden" name="email" value="dindi@dindi.net">
 
<input type="hidden" name="joinList" value="BlackBox">
  <input type="hidden" name="joinDrip" value="Welcome">
  <input type="hidden" name="joinDrip" value="E-marketing">  
  <input type="hidden" name="milestoneOff" value="1st Visit">
  <input type="hidden" name="milestoneOn" value="1st Drip">
  <input type="hidden" name="milestoneOn" value="Ebook">
  <input type="hidden" name="interestOn" value="New Website">
  <input type="hidden" name="interestOn" value="Email Marketing">
  <input type="hidden" name="interestOff" value="Social Media">
  <input type="hidden" name="from" value="webform">
<input type="submit" name="send" value="Send This Stuff">
</form>

<div id="returned"> </div>
<div id="results"></div>

<div id="techsmith-snagitchrome-extension"></div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>
function onreturn(dada){
        document.getElementById("results").innerHTML = JSON.stringify(dada)//dada.joinList + ' : ' + dada.joinDrip + ' : ' + dada.milestoneOn
         var jsonarrdada = Array();
         var subjsonarrdada = Array();
          for (i in dada){
              subjsonarrdada = []
              if(Array.isArray(dada[i])){
                  console.log('da: '+dada[i])
                  //for(j in dada[i]){
                      ////console.log('"'+j+'"' + ' : '+dada[i][j])
                      //subjsonarrdada.push(JSON.stringify('"'+dada[i][j]+'"'))
                  //}
                  //for(k in )
                  //jsonarrdada.push('"'+i+'":['+subjsonarrdada.join(',')+']')
                  //console.log('"'+i+'":['+JSON.stringify(subjsonarrdada.join(','))+']')
              }
              else{
            jsonarrdada.push('"'+i+'":"'+dada[i]+'"');
            //console.log('"'+i+'":"'+dada[i]+'"');
              }
          }

  var data = '{'+jsonarrdada.join(',')+'}';
  //console.log("data: "+data)
  objdata = JSON.parse(data)

  for(i in objdata){
   if(Array.isArray(objdata[i])){
      for( k in objdata[i]){
       //console.log(i+k+':'+objdata[i][k])
      }
   }else{
         // console.log(i+':'+objdata[i])
      }
  }
};

    $.fn.serializeObject = function()
          {
            var o = {};
            var a = this.serializeArray();
            $.each(a, function() {
              if (o[this.name] !== undefined) {
                if (!o[this.name].push) {
                  o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
              } else {
                o[this.name] = this.value || '';
              }
            });
            o['url'] = location.protocol + '//' + location.host + location.pathname;
            return o;
    };

    $('form').submit(function() {
            var thedata = JSON.stringify($(this).serializeObject())
            console.log('The Data = '+thedata)
            var script = document.createElement('script');
            script.src = 'https://script.google.com/macros/s/AKfycbzCW2_f0QrC3qq3KG_-GGcg_msIpHGyOPz9izaqtLGxbLMFbPk/exec?from=webform&data='+thedata;
            document.body.appendChild(script);
            return false;
    });
</script>

</body></html>